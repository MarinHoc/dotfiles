#!/bin/sh
#
# bat-monitor - suspend when battery level is low

toggle=1

battery |
    while read -r capacity status; do
        case $status in
            Discharging)
                [ $((capacity <= 5)) -eq 1 ] && {
                    [ $((toggle == 1)) -eq 1 ] && {
                        sudo zzz

                        toggle=0
                    }

                    :
                } ||
                    toggle=1
                ;;
            *) toggle=1
        esac
    done
