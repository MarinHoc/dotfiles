#!/bin/sh
#
# panel - main panel script

name=panel

. ~/.config/lemonbar/config

# ensure proper panel script cleanup
trap 'trap - TERM; kill 0' INT TERM QUIT EXIT

# run all panel modules
for mod in ~/.config/lemonbar/lemons/*; do
    "$mod" &
done |
    while read -r event; do
        # parse events
        eval "${event%% *}"=\${event#* }

        eval "echo \"$format\""
    done |
        lemonbar -g "x$height" \
            -F "$foreground"   \
            -B "$background"   \
            -f "$icons"        \
            -f "$font"         \
            -n "$name" &

# ensure proper fullscreen
xdo lower -ma "$name"

wait
