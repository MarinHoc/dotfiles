#!/bin/sh
#
# lemonbar script

name=panel

. ~/.config/lemonbar/panel

# ensure proper panel script cleanup
trap 'trap - TERM; kill 0' INT TERM QUIT EXIT

# source all panel modules
for file in ~/.config/lemonbar/lemons/*; do
    . "$file"
done

for func in wks mus clk ntw vol bat; do
    "$func" &
done |
    while read -r event; do
        # parse events
        eval "${event%% *}"=\${event#* }

        eval "echo \"$format\""
    done |
        lemonbar -g "x$height" \
            -F "$foreground"   \
            -B "$background"   \
            -f "$icons"        \
            -f "$font"         \
            -n "$name" &

# ensure proper fullscreen
xdo lower -ma "$name"

wait
