#!/bin/sh

while :; do
    # ensure volume block isn't empty on startup
    { echo; stdbuf -oL alsactl monitor; } |
        while read -r event; do
            var=$(amixer get Master)

            case $var in
                *'[on]')  icon=;;
                *'[off]') icon=
            esac

            var=${var%%]*}
            var=${var#*[}

            echo "vol $icon $var"
        done
done
