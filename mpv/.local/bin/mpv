#!/bin/sh
#
# mpv

dir=/tmp/mpv

# pause mpc
mpc pause > /dev/null 2>&1

# handle multiple mpv sockets
mkdir -p "$dir"

for socket in "$dir"/*; do
    num=${socket##*/}

    [ "$num" != \* ] &&
        [ "$num" -gt "${max:-0}" ] && max=$num
done

socket=$dir/$((max + 1))

trap 'rm -f "$socket"' INT TERM QUIT EXIT

command -p mpv \
    --input-ipc-server="$socket" "$@"
