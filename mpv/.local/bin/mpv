#!/bin/sh
#
# mpv

dir=/tmp/mpv

# pause mpc
mpc pause > /dev/null 2>&1

# handle multiple mpv sockets
for socket in "$dir"-*; do
    num=${socket##*-}

    case $num in
       \*) ;;
        *)
            [ "$num" -gt "${max:-0}" ] &&
                max=$num
    esac
done

max=$((max + 1))

trap 'rm "$dir-$max"' EXIT

command -p mpv \
    --input-ipc-server="$dir-$max" "$@"
